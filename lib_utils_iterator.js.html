<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib/utils/iterator.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">HOME</a></h2><h2><a href="api-overview.html">API OVERVIEW</a></h2><h3>Modules</h3><ul><li><a href="module-app_controller.html">app/controller</a></li><li><a href="module-lib_fsm.html">lib/fsm</a></li><li><a href="module-lib_json.html">lib/json</a><ul class='methods'><li data-type='method'><a href="module-lib_json.html#.deserialize">deserialize</a></li><li data-type='method'><a href="module-lib_json.html#.serialize">serialize</a></li></ul></li><li><a href="module-lib_layoutFsm.html">lib/layoutFsm</a></li><li><a href="module-lib_utils_descriptor.html">lib/utils/descriptor</a></li><li><a href="module-lib_utils_iterator.html">lib/utils/iterator</a><ul class='methods'><li data-type='method'><a href="module-lib_utils_iterator.html#.empty">empty</a></li><li data-type='method'><a href="module-lib_utils_iterator.html#.flatten">flatten</a></li><li data-type='method'><a href="module-lib_utils_iterator.html#.hijack">hijack</a></li><li data-type='method'><a href="module-lib_utils_iterator.html#.wrap">wrap</a></li></ul></li></ul><h3>Classes</h3><ul><li><a href="module-lib_fsm-Fsm.html">lib/fsm~Fsm</a></li><li><a href="module-lib_fsm-Fsm-State.html">lib/fsm~Fsm~State</a><ul class='methods'><li data-type='method'><a href="module-lib_fsm-Fsm-State.html#.add">add</a></li><li data-type='method'><a href="module-lib_fsm-Fsm-State.html#.all">all</a></li><li data-type='method'><a href="module-lib_fsm-Fsm-State.html#.remove">remove</a></li></ul></li><li><a href="module-lib_fsm-Fsm-Symbol.html">lib/fsm~Fsm~Symbol</a><ul class='methods'><li data-type='method'><a href="module-lib_fsm-Fsm-Symbol.html#.add">add</a></li><li data-type='method'><a href="module-lib_fsm-Fsm-Symbol.html#.all">all</a></li><li data-type='method'><a href="module-lib_fsm-Fsm-Symbol.html#.remove">remove</a></li></ul></li><li><a href="module-lib_fsm-Fsm-Transition.html">lib/fsm~Fsm~Transition</a><ul class='methods'><li data-type='method'><a href="module-lib_fsm-Fsm-Transition.html#.add">add</a></li><li data-type='method'><a href="module-lib_fsm-Fsm-Transition.html#.all">all</a></li><li data-type='method'><a href="module-lib_fsm-Fsm-Transition.html#.get">get</a></li><li data-type='method'><a href="module-lib_fsm-Fsm-Transition.html#.groups">groups</a></li><li data-type='method'><a href="module-lib_fsm-Fsm-Transition.html#.remove">remove</a></li><li data-type='method'><a href="module-lib_fsm-Fsm-Transition.html#.select">select</a></li></ul></li><li><a href="module-lib_layoutFsm-Fsm.html">lib/layoutFsm~Fsm</a></li><li><a href="module-lib_layoutFsm-Fsm-State.html">lib/layoutFsm~Fsm~State</a></li><li><a href="module-lib_layoutFsm-Fsm-Symbol.html">lib/layoutFsm~Fsm~Symbol</a><ul class='methods'><li data-type='method'><a href="module-lib_layoutFsm-Fsm-Symbol.html#.add">add</a></li><li data-type='method'><a href="module-lib_layoutFsm-Fsm-Symbol.html#.getFromLabel">getFromLabel</a></li><li data-type='method'><a href="module-lib_layoutFsm-Fsm-Symbol.html#.remove">remove</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">lib/utils/iterator.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module lib/utils/iterator
 */

/**
 * Transforms an iterable of iterables into a flat iterable
 */
export function flatten(iterable, accessIterable) {
  const iterator = iterable[Symbol.iterator];
  let oldNext = iterator.next.bind(iterator);
  let c;
  let subIterator;
  let subc = {done: true};
  iterator.next = () => {
    while(subc.done) {
      c = oldNext();
      if(c.done) {
        return c;
      }
      subIterator = accessIterable(c.value)[Symbol.iterator];
      subc = subIterator.next();
    }
    return subc;
  };
  return iterable; 
};

/**
 * Creates an empty iterable/iterator
 */
export function empty() {
  const iter = {
    next: () => ({done: true})
  };
  iter[Symbol.iterator] = iter;
  return iter;
};

/**
 * Wraps a variable in an iterable/iterator
 */
export function wrap(value) {
  let seen = false;
  const iter = {
    next: () => {
      if(seen) {
        return {done: true};
      } 
      seen = true;
      return {value};
    }
  };
  iter[Symbol.iterator] = iter;
  return iter;
};

/**
 * Apply a function on a value when accessing it
 */
export function hijack(iterable, callback) {
  const iterator = iterable[Symbol.iterator];
  const oldNext = iterator.next.bind(iterator);
  iterator.next = () => {
    const c = oldNext();
    if(!c.done) {
      c.value = callback(c.value);
    }
    return n;
  };
  return iterable;
};
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Thu Apr 14 2016 15:27:39 GMT+0200 (CEST) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
